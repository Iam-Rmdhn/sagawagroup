const e="http://localhost:4000";function t(e){let t=document.getElementById("error-notification");t||(t=document.createElement("div"),t.id="error-notification",t.className="fixed top-4 right-4 bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded z-50",document.body.appendChild(t)),t.textContent=e,t.style.display="block"}function n(e){const t=e.mitraDetail||{},n=e.namaMitra||t.namaMitra||"Mitra User",o=e.email||t.email||"mitra@sagawa.com",a=e.noHp||t.noHp||"N/A",i=e.alamatMitra||t.alamatMitra||"N/A",d=e.paketUsaha||t.paketUsaha||"N/A",r=e.sales||t.sales||"N/A",l=e.sistemKemitraan||t.sistemKemitraan||"N/A",s=void 0!==e.isApproved?e.isApproved:t.isApproved,c=e.status||t.status,m=e.joinDate||t.createdAt||e.createdAt;!function(e,t){const n=document.getElementById("user-name"),o=document.getElementById("user-email"),a=document.getElementById("user-avatar"),i=document.getElementById("welcome-name");n&&(n.textContent=e);o&&(o.textContent=t);a&&(a.textContent=e[0].toUpperCase());i&&(i.textContent=e)}(n,o),function(e,t,n,o){const a=document.getElementById("business-package");a&&(a.textContent=e);const i=document.getElementById("sales-name");i&&(i.textContent=t);const d=document.getElementById("mitra-status");d&&(n&&"approved"===o?(d.textContent="Aktif",d.className="text-2xl text-green-600 font-bold"):"pending"===o?(d.textContent="Menunggu Persetujuan",d.className="text-2xl text-yellow-600 font-bold"):(d.textContent="Tidak Aktif",d.className="text-2xl text-red-600 font-bold"))}(d,r,s,c),function(e,t,n,o){const a=document.getElementById("account-email"),i=document.getElementById("account-phone"),d=document.getElementById("account-address"),r=document.getElementById("join-date");a&&(a.textContent=e);i&&(i.textContent=t);d&&(d.textContent=n);if(r)if(o){const e=new Date(o).toLocaleDateString("id-ID",{year:"numeric",month:"long",day:"numeric"});r.textContent=e}else r.textContent="N/A"}(o,a,i,m),function(e,t,n,o,a,i,d,r,l){const s=document.getElementById("profile-name"),c=document.getElementById("profile-email"),m=document.getElementById("profile-phone"),u=document.getElementById("profile-address"),g=document.getElementById("profile-package"),p=document.getElementById("profile-system"),f=document.getElementById("profile-sales"),y=document.getElementById("profile-status");s&&(s.value=e);c&&(c.value=t);m&&(m.value=n);u&&(u.value=o);g&&(g.value=a);p&&(p.value=i);f&&(f.value=d);y&&(r&&"approved"===l?(y.textContent="Disetujui",y.className="inline-block px-3 py-1 bg-green-100 text-green-800 rounded-full text-sm font-medium"):"pending"===l?(y.textContent="Menunggu Persetujuan",y.className="inline-block px-3 py-1 bg-yellow-100 text-yellow-800 rounded-full text-sm font-medium"):(y.textContent="Ditolak",y.className="inline-block px-3 py-1 bg-red-100 text-red-800 rounded-full text-sm font-medium"))}(n,o,a,i,d,l,r,s,c)}document.addEventListener("DOMContentLoaded",function(){!async function(){const o=localStorage.getItem("mitraToken");if(!o)return void(window.location.href="/login");try{const t=await fetch(`${e}/api/mitra/profile`,{method:"GET",headers:{Authorization:`Bearer ${o}`,"Content-Type":"application/json"}});if(!t.ok){if(401===t.status)return localStorage.removeItem("mitraToken"),localStorage.removeItem("mitraUser"),void(window.location.href="/login");throw new Error(`HTTP error! status: ${t.status}`)}const a=await t.json();if(!a.success||!a.data)throw new Error("Invalid response format");n(a.data),localStorage.setItem("mitraUser",JSON.stringify(a.data))}catch(a){t("Gagal memuat data profil. Mencoba menggunakan data tersimpan...");const e=localStorage.getItem("mitraUser");if(e)try{n(JSON.parse(e)),function(){const e=document.getElementById("error-notification");e&&(e.style.display="none")}()}catch(i){t("Data profil tidak dapat dimuat. Silakan login kembali."),setTimeout(()=>{window.location.href="/login"},3e3)}else t("Sesi Anda telah berakhir. Dialihkan ke halaman login..."),setTimeout(()=>{window.location.href="/login"},3e3)}}(),function(){const e=document.getElementById("user-menu-button"),t=document.getElementById("dropdown-user");e&&t&&(e.addEventListener("click",function(e){e.stopPropagation(),t.classList.toggle("hidden")}),document.addEventListener("click",function(){t.classList.add("hidden")}));const n=document.getElementById("logout-btn");n&&n.addEventListener("click",function(e){e.preventDefault(),confirm("Apakah Anda yakin ingin logout?")&&(localStorage.removeItem("mitraToken"),localStorage.removeItem("mitraUser"),window.location.href="/login")});["dashboard","profile","business","support"].forEach(e=>{const t=document.getElementById(`${e}-btn`);t&&t.addEventListener("click",function(n){var o;n.preventDefault(),function(e){["dashboard-content","profile-content","business-content","support-content"].forEach(e=>{const t=document.getElementById(e);t&&t.classList.add("hidden")});const t=document.getElementById(`${e}-content`);t&&t.classList.remove("hidden")}(e),o=t,document.querySelectorAll("#logo-sidebar a").forEach(e=>{e.classList.remove("bg-gray-100","text-gray-900","dark:bg-gray-700","dark:text-white")}),o.classList.add("bg-gray-100","text-gray-900","dark:bg-gray-700","dark:text-white")})});const o=document.querySelector('[data-drawer-toggle="logo-sidebar"]'),a=document.getElementById("logo-sidebar");o&&a&&o.addEventListener("click",function(){a.classList.toggle("-translate-x-full")})}()});
