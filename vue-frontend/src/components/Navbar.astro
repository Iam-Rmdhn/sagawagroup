---
// Navbar.astro
import sagawaLogo from '../assets/img/sagawa_logo.svg?url';
---

<nav class="bg-white sticky top-0 z-50">
  <div class="max-w-7xl w-full mx-auto px-4 sm:px-6 lg:px-8">
    <div class="flex justify-between items-center h-16">
      <!-- Logo -->
      <div class="flex-shrink-0">
        <a href="/" class="flex items-center">
          <img src={sagawaLogo} alt="Sagawa Group Logo" class="h-10 w-auto mr-2" />
        </a>
      </div>

      <!-- Desktop Navigation (tidak berubah) -->
      <div class="hidden lg:flex">
        <div class="flex items-center space-x-6">
          <a href="/" class="nav-link flex items-center text-gray-600 px-2 py-2 text-sm font-medium transition-colors duration-200 relative">
            <svg class="w-4 h-4 mr-1 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m2.25 12 8.954-8.955c.44-.439 1.152-.439 1.591 0L21.75 12M4.5 9.75v10.125c0 .621.504 1.125 1.125 1.125H9.75v-4.875c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125V21h4.125c.621 0 1.125-.504 1.125-1.125V9.75M8.25 21h8.25"/>
            </svg>
            Beranda
          </a>
          
          <div class="relative">
            <a href="/mitra" class="nav-link flex items-center text-gray-600 px-2 py-2 text-sm font-medium transition-colors duration-200 relative">
              <svg class="w-4 h-4 mr-1 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 12c.263 0 .524-.06.767-.175a2 2 0 0 0 .65-.491c.186-.21.333-.46.433-.734.1-.274.15-.568.15-.864a2.4 2.4 0 0 0 .586 1.591c.375.422.884.659 1.414.659.53 0 1.04-.237 1.414-.659A2.4 2.4 0 0 0 12 9.736a2.4 2.4 0 0 0 .586 1.591c.375.422.884.659 1.414.659.53 0 1.04-.237 1.414-.659A2.4 2.4 0 0 0 16 9.736c0 .295.052.588.152.861s.248.521.434.73a2 2 0 0 0 .649.488 1.809 1.809 0 0 0 1.53 0 2.03 2.03 0 0 0 .65-.488c.185-.209.332-.457.433-.73.1-.273.152-.566.152-.861 0-.974-1.108-3.85-1.618-5.121A.983.983 0 0 0 17.466 4H6.456a.986.986 0 0 0-.93.645C5.045 5.962 4 8.905 4 9.736c.023.59.241 1.148.611 1.567.37.418.865.667 1.389.697Zm0 0c.328 0 .651-.091.94-.266A2.1 2.1 0 0 0 7.66 11h.681a2.1 2.1 0 0 0 .718.734c.29.175.613.266.942.266.328 0 .651-.091.94-.266.29-.174.537-.427.719-.734h.681a2.1 2.1 0 0 0 .719.734c.289.175.612.266.94.266.329 0 .652-.091.942-.266.29-.174.536-.427.718-.734h.681c.183.307.43.56.719.734.29.174.613.266.941.266a1.819 1.819 0 0 0 1.06-.351M6 12a1.766 1.766 0 0 1-1.163-.476M5 12v7a1 1 0 0 0 1 1h2v-5h3v5h7a1 1 0 0 0 1-1v-7m-5 3v2h2v-2h-2Z"/>
              </svg>
              Produk Kemitraan
              <button id="desktop-mitra-arrow-button" class="ml-auto p-2">
                <svg id="desktop-mitra-arrow" class="w-4 h-4 text-gray-600 transform transition-transform duration-200" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m19 9-7 7-7-7"/>
                </svg>
              </button>
            </a>
            <div id="desktop-mitra-menu" class="absolute z-10 opacity-0 invisible transform scale-95 bg-white shadow-lg border-gray-500 rounded-md mt-2 min-w-full whitespace-nowrap transition-all duration-300 ease-in">
              <a href="/mitra/kagawa-ricebowl" class="block px-4 py-2 text-sm text-gray-600 hover:bg-gray-100 rounded-md transition-colors duration-200">Kagawa Ricebowl</a>
              <a href="/mitra/kagawa-coffee-corner" class="block px-4 py-2 text-sm text-gray-600 hover:bg-gray-100 transition-colors duration-200">Kagawa Coffee Corner</a>
              <a href="/mitra/kagawa-coffee-ricebowl" class="block px-4 py-2 text-sm text-gray-600 hover:bg-gray-100 transition-colors duration-200">Kagawa Coffee & Ricebowl</a>
              <a href="/mitra/rm-nusantara" class="block px-4 py-2 text-sm text-gray-600 hover:bg-gray-100 transition-colors duration-200">RM Nusantara</a>
              <a href="/mitra/indepandant-brand" class="block px-4 py-2 text-sm text-gray-600 hover:bg-gray-100 rounded-md transition-colors duration-200">Independant Brand</a>
            </div>
          </div>
          
          <a href="/menu" class="nav-link flex items-center text-gray-600 px-2 py-2 text-sm font-medium transition-colors duration-200 relative">
            <svg class="w-4 h-4 mr-1 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M18.011 13H20c-.367 2.5551-2.32 4.6825-4.9766 5.6162V20H8.97661v-1.3838C6.31996 17.6825 4.36697 15.5551 4 13h14.011Zm0 0c1.0995-.0059 1.989-.8991 1.989-2 0-.8637-.5475-1.59948-1.3143-1.87934M18.011 13H18m0-3.99997c.2409 0 .4718.04258.6857.12063m0 0c.8367-1.0335.7533-2.67022-.2802-3.50694-1.0335-.83672-2.5496-.6772-3.3864.35631-.293-1.50236-1.7485-2.15377-3.2509-1.8607-1.5023.29308-2.48263 1.74856-2.18956 3.25092C8.9805 6.17263 7.6182 5.26418 6.15462 6.00131 4.967 6.59945 4.45094 8.19239 5.04909 9.38002m0 0C4.37083 9.66467 4 10.3357 4 11.1174 4 12.1571 4.84288 13 5.88263 13m-.83354-3.61998c.2866-.12029 1.09613-.40074 2.04494.3418m5.27497-.89091c1.0047-.4589 2.1913-.01641 2.6502.98832"/>
            </svg>
            Menu
          </a>
          
          <a href="/gallery" class="nav-link flex items-center text-gray-600 px-2 py-2 text-sm font-medium transition-colors duration-200 relative">
            <svg class="w-4 h-4 mr-1 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m3 16 5-7 6 6.5m6.5 2.5L16 13l-4.286 6M14 10h.01M4 19h16a1 1 0 0 0 1-1V6a1 1 0 0 0-1-1H4a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1Z"/>
            </svg>
            Galeri
          </a>
          
          <a href="/about" class="nav-link flex items-center text-gray-600 px-2 py-2 text-sm font-medium transition-colors duration-200 relative">
            <svg class="w-4 h-4 mr-1 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 11h2v5m-2 0h4m-2.592-8.5h.01M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"/>
            </svg>
            Tentang Kami
          </a>
                  
          <a href="/contact" class="nav-link flex items-center text-gray-600 px-2 py-2 text-sm font-medium transition-colors duration-200 relative">
            <svg class="w-4 h-4 mr-1 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M18.427 14.768 17.2 13.542a1.733 1.733 0 0 0-2.45 0l-.613.613a1.732 1.732 0 0 1-2.45 0l-1.838-1.84a1.735 1.735 0 0 1 0-2.452l.612-.613a1.735 1.735 0 0 0 0-2.452L9.237 5.572a1.6 1.6 0 0 0-2.45 0c-3.223 3.2-1.702 6.896 1.519 10.117 3.22 3.221 6.914 4.745 10.12 1.535a1.601 1.601 0 0 0 0-2.456Z"/>
            </svg>
            Kontak
          </a>
        </div>
      </div>

      <!-- Login & Register Buttons -->
      <div class="flex items-center space-x-3">
        <a href="/login" class="hidden lg:flex bg-amber-600 hover:bg-amber-700 text-white px-4 py-2 rounded text-sm font-medium transition-colors duration-200 items-center shadow-sm">
          Login
          <svg class="w-4 h-4 ml-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m12.75 15 3-3m0 0-3-3m3 3h-7.5M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"/>
          </svg>
        </a>

        <!-- Mobile menu button -->
        <div class="lg:hidden">
          <button type="button" id="mobile-menu-button" class="text-gray-600 hover:text-red-500 focus:outline-none focus:text-red-500 p-2">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/>
            </svg>
          </button>
        </div>
      </div>
    </div>
  </div>
  
  <div id="mobile-menu" class="lg:hidden opacity-0 invisible transform -translate-y-2 fixed inset-x-0 top-16 bg-white z-50 shadow-lg border-t border-gray-200 transition-all duration-300 ease-out">
    <div class="w-full">
      <a href="/" class="mobile-nav-link flex items-center text-gray-600 hover:text-red-500 px-4 py-3 text-base font-medium w-full border-b border-gray-200 transition-colors duration-200">
        <svg class="w-4 h-4 mr-3 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m2.25 12 8.954-8.955c.44-.439 1.152-.439 1.591 0L21.75 12M4.5 9.75v10.125c0 .621.504 1.125 1.125 1.125H9.75v-4.875c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125V21h4.125c.621 0 1.125-.504 1.125-1.125V9.75M8.25 21h8.25"/>
        </svg>
        Beranda
      </a>
      
      <div class="border-b border-gray-200 w-full">
        <div class="flex items-center justify-between">
          <a href="/mitra" class="mobile-nav-link flex-grow flex items-center text-gray-600 hover:text-red-500 px-4 py-3 text-base font-medium transition-colors duration-200">
            <svg class="w-4 h-4 mr-3 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 12c.263 0 .524-.06.767-.175a2 2 0 0 0 .65-.491c.186-.21.333-.46.433-.734.1-.274.15-.568.15-.864a2.4 2.4 0 0 0 .586 1.591c.375.422.884.659 1.414.659.53 0 1.04-.237 1.414-.659A2.4 2.4 0 0 0 12 9.736a2.4 2.4 0 0 0 .586 1.591c.375.422.884.659 1.414.659.53 0 1.04-.237 1.414-.659A2.4 2.4 0 0 0 16 9.736c0 .295.052.588.152.861s.248.521.434.73a2 2 0 0 0 .649.488 1.809 1.809 0 0 0 1.53 0 2.03 2.03 0 0 0 .65-.488c.185-.209.332-.457.433-.73.1-.273.152-.566.152-.861 0-.974-1.108-3.85-1.618-5.121A.983.983 0 0 0 17.466 4H6.456a.986.986 0 0 0-.93.645C5.045 5.962 4 8.905 4 9.736c.023.59.241 1.148.611 1.567.37.418.865.667 1.389.697Zm0 0c.328 0 .651-.091.94-.266A2.1 2.1 0 0 0 7.66 11h.681a2.1 2.1 0 0 0 .718.734c.29.175.613.266.942.266.328 0 .651-.091.94-.266.29-.174.537-.427.719-.734h.681a2.1 2.1 0 0 0 .719.734c.289.175.612.266.94.266.329 0 .652-.091.942-.266.29-.174.536-.427.718-.734h.681c.183.307.43.56.719.734.29.174.613.266.941.266a1.819 1.819 0 0 0 1.06-.351M6 12a1.766 1.766 0 0 1-1.163-.476M5 12v7a1 1 0 0 0 1 1h2v-5h3v5h7a1 1 0 0 0 1-1v-7m-5 3v2h2v-2h-2Z"/>
            </svg>
            Produk Kemitraan
          </a>
          <button id="mobile-mitra-button" class="p-3 pr-4 transition-all duration-200 hover:bg-gray-50 rounded-lg">
            <svg id="mobile-mitra-arrow" class="w-4 h-4 text-gray-600 transform transition-transform duration-300 ease-out" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m19 9-7 7-7-7"/>
            </svg>
          </button>
        </div>
        <div id="mobile-mitra-menu" class="overflow-hidden transition-all duration-300 ease-out max-h-0 border-t border-gray-100">
          <a href="/mitra/kagawa-ricebowl" class="submenu-nav-link block py-2 text-sm text-gray-600 hover:text-red-500 pl-11 pr-4 transition-colors duration-200">Kagawa Ricebowl</a>
          <a href="/mitra/kagawa-coffee-corner" class="submenu-nav-link block py-2 text-sm text-gray-600 hover:text-red-500 pl-11 pr-4 transition-colors duration-200">Kagawa Coffee Corner</a>
          <a href="/mitra/kagawa-coffee-ricebowl" class="submenu-nav-link block py-2 text-sm text-gray-600 hover:text-red-500 pl-11 pr-4 transition-colors duration-200">Kagawa Coffee & Ricebowl</a>
          <a href="/mitra/rm-nusantara" class="submenu-nav-link block py-2 text-sm text-gray-600 hover:text-red-500 pl-11 pr-4 transition-colors duration-200">RM Nusantara</a>
          <a href="/mitra/indepandant-brand" class="submenu-nav-link block py-2 text-sm text-gray-600 hover:text-red-500 pl-11 pr-4 transition-colors duration-200">Independant Brand</a>
        </div>
      </div>
      
      <a href="/menu" class="mobile-nav-link flex items-center text-gray-600 hover:text-red-500 px-4 py-3 text-base font-medium w-full border-b border-gray-200 transition-colors duration-200">
        <svg class="w-4 h-4 mr-3 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M18.011 13H20c-.367 2.5551-2.32 4.6825-4.9766 5.6162V20H8.97661v-1.3838C6.31996 17.6825 4.36697 15.5551 4 13h14.011Zm0 0c1.0995-.0059 1.989-.8991 1.989-2 0-.8637-.5475-1.59948-1.3143-1.87934M18.011 13H18m0-3.99997c.2409 0 .4718.04258.6857.12063m0 0c.8367-1.0335.7533-2.67022-.2802-3.50694-1.0335-.83672-2.5496-.6772-3.3864.35631-.293-1.50236-1.7485-2.15377-3.2509-1.8607-1.5023.29308-2.48263 1.74856-2.18956 3.25092C8.9805 6.17263 7.6182 5.26418 6.15462 6.00131 4.967 6.59945 4.45094 8.19239 5.04909 9.38002m0 0C4.37083 9.66467 4 10.3357 4 11.1174 4 12.1571 4.84288 13 5.88263 13m-.83354-3.61998c.2866-.12029 1.09613-.40074 2.04494.3418m5.27497-.89091c1.0047-.4589 2.1913-.01641 2.6502.98832"/>
        </svg>
        Menu
      </a>

      <a href="/gallery" class="mobile-nav-link flex items-center text-gray-600 hover:text-red-500 px-4 py-3 text-base font-medium w-full border-b border-gray-200 transition-colors duration-200">
        <svg class="w-4 h-4 mr-3 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"  d="m3 16 5-7 6 6.5m6.5 2.5L16 13l-4.286 6M14 10h.01M4 19h16a1 1 0 0 0 1-1V6a1 1 0 0 0-1-1H4a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1Z"/>
        </svg>
        Galeri
      </a>

      <a href="/about" class="mobile-nav-link flex items-center text-gray-600 hover:text-red-500 px-4 py-3 text-base font-medium w-full border-b border-gray-200 transition-colors duration-200">
        <svg class="w-4 h-4 mr-3 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 11h2v5m-2 0h4m-2.592-8.5h.01M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"/>
        </svg>
        Tentang Kami
      </a>

      <a href="/contact" class="mobile-nav-link flex items-center text-gray-600 hover:text-red-500 px-4 py-3 text-base font-medium w-full border-b border-gray-200 transition-colors duration-200">
        <svg class="w-4 h-4 mr-3 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M18.427 14.768 17.2 13.542a1.733 1.733 0 0 0-2.45 0l-.613.613a1.732 1.732 0 0 1-2.45 0l-1.838-1.84a1.735 1.735 0 0 1 0-2.452l.612-.613a1.735 1.735 0 0 0 0-2.452L9.237 5.572a1.6 1.6 0 0 0-2.45 0c-3.223 3.2-1.702 6.896 1.519 10.117 3.22 3.221 6.914 4.745 10.12 1.535a1.601 1.601 0 0 0 0-2.456Z"/>
        </svg>
        Kontak
      </a>

      <!-- Login & Register Buttons for Mobile -->
      <div class="p-2 ml-4 border-t border-gray-200 space-y-2">
        <a href="/login" class="mobile-nav-link inline-flex items-center border font-sans font-medium text-center transition-all duration-300 ease-in disabled:opacity-50 disabled:shadow-none disabled:cursor-not-allowed data-[shape=pill]:rounded-full data-[width=full]:w-full focus:shadow-none text-sm rounded-md py-2 px-4 shadow-sm hover:shadow-md bg-amber-500 border-amber-800 text-slate-50 hover:bg-amber-700 hover:border-amber-800">
          Login
          <svg class="w-4 h-4 ml-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m12.75 15 3-3m0 0-3-3m3 3h-7.5M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"/>
          </svg>
        </a>
      </div>
    </div>
  </div>
</nav>

<style>
  a {
    font-weight: bold;
  }

  .nav-link-active,
  .mobile-nav-link-active {
    color: #e3342f;
  }

  #desktop-mitra-arrow-button:focus {
    outline: none;
    box-shadow: none;
  }

  a:focus, button:focus {
    outline: none;
    box-shadow: none;
  }

  *:focus {
    outline: none !important;
    box-shadow: none !important;
  }

  #mobile-menu {
    position: fixed;
    left: 0;
    right: 0;
    width: 100vw;
    overflow-y: auto;
    max-height: calc(100vh - 4rem);
    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
    margin: 0;
    padding: 0;
  }

  #mobile-menu > div {
    display: flex;
    flex-direction: column;
    width: 100%;
  }

  /* Enhanced dropdown animation states */
  #desktop-mitra-menu.show {
    opacity: 1;
    visibility: visible;
    transform: translateY(0) scale(1);
  }

  #mobile-menu.show {
    opacity: 1;
    visibility: visible;
    transform: translateY(0);
  }

  #mobile-mitra-menu.show {
    max-height: 300px; /* Adjust based on content */
  }

  /* Style untuk submenu */
  #mobile-mitra-menu {
    background-color: #f9fafb;
    width: 100%;
  }

  .mobile-nav-link-active {
    color: #e3342f !important;
    background-color: rgba(251, 146, 60, 0.1);
    border-left: 3px solid #e3342f;
    padding-left: calc(1rem - 3px) !important;
  }

  .submenu-nav-link.submenu-nav-link-active {
    color: #e3342f !important;
    background-color: rgba(251, 146, 60, 0.1);
    border-left: 3px solid #e3342f;
    padding-left: calc(2.75rem - 3px) !important; 
  }

  .mobile-nav-link-active::before {
    content: none;
  }

  @media (min-width: 1024px) {
    .nav-link:hover,
    .nav-link.nav-link-active {
      color: #e3342f;
    }

    .nav-link::after {
      content: '';
      position: absolute;
      bottom: -2px;
      left: 25%;
      width: 0;
      height: 2px;
      background-color: #e3342f;
      transition: width 0.3s ease-in-out;
    }

    .nav-link:hover::after,
    .nav-link.nav-link-active::after {
      width: 50%;
    }
  }
</style>

<script>
  // Toggle mobile menu with smooth animation
  const mobileMenuButton = document.getElementById('mobile-menu-button');
  const mobileMenu = document.getElementById('mobile-menu');

  if (mobileMenuButton && mobileMenu) {
    mobileMenuButton.addEventListener('click', () => {
      if (mobileMenu.classList.contains('show')) {
        // Hide menu
        mobileMenu.classList.remove('show');
        setTimeout(() => {
          mobileMenu.style.pointerEvents = 'none';
        }, 300);
      } else {
        // Show menu
        mobileMenu.style.pointerEvents = 'auto';
        mobileMenu.classList.add('show');
      }
    });

    // Close mobile menu when clicking outside
    document.addEventListener('click', (event) => {
      if (!mobileMenuButton.contains(event.target as Node) && !mobileMenu.contains(event.target as Node)) {
        mobileMenu.classList.remove('show');
        setTimeout(() => {
          mobileMenu.style.pointerEvents = 'none';
        }, 300);
      }
    });
  }

  // Toggle mobile mitra submenu with smooth animation
  const mobileMitraButton = document.getElementById('mobile-mitra-button');
  const mobileMitraMenu = document.getElementById('mobile-mitra-menu');
  const mobileMitraArrow = document.getElementById('mobile-mitra-arrow');

  if (mobileMitraButton && mobileMitraMenu && mobileMitraArrow) {
    mobileMitraButton.addEventListener('click', () => {
      if (mobileMitraMenu.classList.contains('show')) {
        // Hide submenu
        mobileMitraMenu.classList.remove('show');
        mobileMitraArrow.classList.remove('rotate-180');
      } else {
        // Show submenu
        mobileMitraMenu.classList.add('show');
        mobileMitraArrow.classList.add('rotate-180');
      }
    });
  }

  // Set active nav link
  document.addEventListener('DOMContentLoaded', () => {
    const navLinks = document.querySelectorAll('.nav-link');
    const mobileNavLinks = document.querySelectorAll('.mobile-nav-link');
    const currentPath = window.location.pathname;

    navLinks.forEach(link => {
      if (link instanceof HTMLAnchorElement) {
        const linkPath = new URL(link.href).pathname;
        if ((linkPath === '/' && currentPath === '/') || (linkPath !== '/' && currentPath.startsWith(linkPath))) {
          link.classList.add('nav-link-active');
        }
      }
    });

    mobileNavLinks.forEach(link => {
      if (link instanceof HTMLAnchorElement) {
        const linkPath = new URL(link.href).pathname;
        if (currentPath === linkPath) {
          link.classList.add('mobile-nav-link-active');
        }
      }
    });

    // Set active state untuk submenu links
    const submenuLinks = document.querySelectorAll('.submenu-nav-link');
    submenuLinks.forEach(link => {
      if (link instanceof HTMLAnchorElement) {
        const linkPath = new URL(link.href).pathname;
        if (currentPath === linkPath) {
          link.classList.add('submenu-nav-link-active');
        }
      }
    });

    // Handle active state for main /mitra link on desktop when on a subpage
    if (currentPath.startsWith('/mitra')) {
        const desktopMitraLink = document.querySelector('a#desktop-mitra-button');
        desktopMitraLink?.classList.add('nav-link-active');
    }

    // Handle active state for main /mitra link on mobile when on a subpage
    if (currentPath.startsWith('/mitra')) {
        const mainMobileMitraLink = document.querySelector('a.mobile-nav-link[href="/mitra"]');
        mainMobileMitraLink?.classList.add('mobile-nav-link-active');
    }


    // Automatically open the mobile submenu if on a mitra page with smooth animation
    if (currentPath.startsWith('/mitra')) {
      const mitraMenu = document.getElementById('mobile-mitra-menu');
      const arrow = document.getElementById('mobile-mitra-arrow');
      if (mitraMenu && arrow) {
        mitraMenu.classList.add('show');
        arrow.classList.add('rotate-180');
      }
    }
  });

  // Toggle desktop mitra submenu with smooth animation
  const desktopMitraButton = document.querySelector('a[href="/mitra"]');
  const desktopMitraArrowButton = document.getElementById('desktop-mitra-arrow-button');
  const desktopMitraMenu = document.getElementById('desktop-mitra-menu');
  const desktopMitraArrow = document.getElementById('desktop-mitra-arrow');

  if (desktopMitraArrowButton && desktopMitraMenu && desktopMitraArrow) {
    desktopMitraArrowButton.addEventListener('click', (event) => {
      event.preventDefault();
      event.stopPropagation();
      
      if (desktopMitraMenu.classList.contains('show')) {
        // Hide menu
        desktopMitraMenu.classList.remove('show');
        desktopMitraArrow.classList.remove('rotate-180');
      } else {
        // Show menu
        desktopMitraMenu.classList.add('show');
        desktopMitraArrow.classList.add('rotate-180');
      }
    });

    // Close dropdown when clicking outside
    document.addEventListener('click', (event) => {
      if (desktopMitraButton && !desktopMitraButton.contains(event.target as Node) && !desktopMitraMenu.contains(event.target as Node)) {
        desktopMitraMenu.classList.remove('show');
        desktopMitraArrow.classList.remove('rotate-180');
      }
    });

    // Prevent dropdown from closing when clicking inside
    desktopMitraMenu.addEventListener('click', (event) => {
      event.stopPropagation();
    });
  }
</script>
